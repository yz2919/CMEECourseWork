\documentclass[a4paper,11pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref, setspace, lineno, amsmath, amssymb, longtable}
\usepackage{float} %% fix graphs at where they should be
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{enumerate}
\usepackage{booktabs}
\usepackage{threeparttable}
\usepackage[round]{natbib} 
\bibliographystyle{plainnat}

%you can add more packages using the same code above

%------------------

%\setlength{\topmargin}{0.0in}
%\setlength{\textheight}{10in}
%\setlength{\oddsidemargin}{0.0in}
%\setlength{\evensidemargin}{0.0in}
%\setlength{\textwidth}{6.5in}

%-------------------
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}


\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem*{example}{Example}

%------------------
\newcommand{\ReportAuthor}{Yuqing Zhou}
\newcommand{\ReportAffil}{Department of Life Sciences, Faculty of Natural Sciences,\\Imperial College London}
\newcommand{\ReportTitle}{Comparison of Models for Fitting Population Growth Curves}


%------------------
%Everything before begin document is called the pre-amble and sets out how the document will look
%It is recommended you don't touch the pre-amble until you are familiar with LateX
\setlength{\marginparwidth}{2cm}
\doublespacing



\begin{document}
    %\maketitle
    \begin{titlepage}
        \vspace{10pt}
        \begin{figure}[!ht]
            \centering
                \begin{center}
                     \includegraphics[width=\linewidth]{../results/IMP_LOGO.jpg}
                \end{center}
        \end{figure}

        \vspace{5pt}
    	\begin{center}
            \Huge\textbf{\ReportTitle}\\
        \end{center}
        
        \begin{center}
        \vspace{\fill}
            \LARGE\ReportAuthor\\
		    \vspace{6pt}
            \Large\ReportAffil
        \end{center}
        	
        \begin{center}
        \vspace{\fill}
    	    \normalsize{March, 2020}
        \end{center}       
        \begin{flushright}
		    \normalsize Approximate Word Count: %% insert approx word count
	    \end{flushright}
    \end{titlepage}
    

\title{Comparison of Models for fitting Population Growth Curves}
\author{Yuqing Zhou\ (CID: 01807289)}

\date{}
\maketitle
\linenumbers
\begin{abstract}
Several models(logistic, Gompertz, Baranyi, Buchunana) were compared by assessing the fits of the models of ...an emperical dataset
\end{abstract}
\textbf{Keywords:} Model selection, microbial population growth rate, model Comparison, logistic growth, Gompertz model, Baranyi model
%The following code is not run because of the percentage sign, but you might find it useful for future work
% \tableofcontents

\section{Introduction}
Linear and nonlinear regression analysis has become an essential tool to analyze biological data and make biological inferences. Models have been developed to allow the description of observed biological patterns in general ways which provide insight into responsible factors \citep{johnson2004model}. The approach of model selection offers a quantitative way to measure relative support for a set of competing hypotheses represented by models, which has become a preferred alternative to null hypothesis testing approach to answer ecological and evolutionary questions \citep{hilborn1997ecological}. \\
One of the widely accepted modeling dichotomies illustrated is mechanistic (process) and phenomenological (pattern) models \citep{bolker2008ecological}. The phenomenological model aims to quantify experimentally observed patterns and is not derived from mechanistic considerations, while the mechanistic model concerned more with the underlying processes based on theoretical expectations. The use of mathematical models is increasingly employed in microbiology to describe and predict the behaviour of microorganisms, which bears tremendous hopes in application in field of food microbiology and other areas (e.g. \citealp{baranyi1995mathematics}).\\
Typical microbial growth in a closed habitat, e.g. batch culture follows a four distinct stages including lag phase, exponential growth phase, stationary phases and mortality phase \citep{mckellar2004primary}. During the lag phase
the cells are assumed to start a growth rate of zero from initial population size ($N_{0}$) and prepare for growth before beginning exponential growth, resulting in a lag time ($t_{lag}$). During the exponential phase, cells accelerate to a maximum growth level ($N_{max}$). The maximum growth rate($r_{max}$) is traditionally defined by the slope of the straight line fitted in the exponential phase. During the stationary phase, the growth rate slows as the population size nears carrying capacity, and then the number of cells in the culture stabilises.\\
The majority of the developed models found in literature do not consider the mortality phase, such as the Gompertz models \citep{gibson1988predicting}, the Baranyi model \citep{baranyi1995mathematics}, the Buchanan model (or the three-phase logistic model, \citealp{buchanan1997simple}),and logistical model \citep{ricker1979growth}. \\
Various models devised hitherto contain the four parameters mentioned above ($N_{0}$, $t_{lag}$, $N_{max}$ and $r_{max}$). In this work, the phenomenological models including cubic polynomial models,  the logistic model with $t_{lag}$, the modified Gompertz models \citep{zwietering1990modeling}, the Baranyi and the Buchanan model, and mechanistic model - the logistic model (does not contain $t_{lag}$), were analysed and evaluated. The objective of this work is to address the question of how well do different mathematical models fit to growth curve across species.

%Using the percentage symbol, you can include comments in your code that do not appear in the output.
\section{Methods}
\subsection{Fitting Model}
Five model, the cubic polynomial models, the logistic model, the shifted logistic model, the Gompetz model, the Baranyi model and the Buchanan model were compared.\\
\textbf{Cubic polynomial model (Eqn 1.)}
\begin{align}
    N = N_0 + N_1 T + N_2 T^2 + N_3 T^3
\end{align}
The cubic polynomial model describes changes in population size ($N$) at any given time ($T$). Time is measured in hours. None of the parameters have any biological meaning in this case. \\
\textbf{Logistic Growth Model(Eqn 2.)}
\begin{align}
    N_t = \frac{N_0 N_{max} e^{rt}}{N_{max}+N_0(e^{rt}-1)}
\end{align}
$N_t$ is population size at time $t$, $N_0$ is initial population size, $r$ is maximum growth rate (AKA $r_{max}$), $N_{max}$ is maximum population density (AKA carrying capacity).\\
\textbf{Logistic Growth Model with a Lag Time (Eqn 3.)}
\begin{equation}
    N_t = \frac{N_0 N_{max} e^{rt}}{N_{max}+N_0(e^{rt}-1)}
\end{equation}
$N_t$ is population size at time $t$, $N_0$ is initial population size, $r$ is maximum growth rate (AKA $r_{max}$), $N_{max}$ is maximum population density (AKA carrying capacity).\\
\textbf{Gompertz Model(Eqn 4.)}
\begin{align}
    N_t = Ae^{-e^{\frac{r_{max}e(t_{lag}-t)}{A}+1}}\\
    A=ln(\frac{N_{max}}{N_0})
\end{align}
The maximum growth rate ($r_{max}$) is the tangent to the inflection point, $t_{lag}$ is the x-axis intercept to this tangent (duration of the delay before the population starts growing exponentially) $A$ is the asymptote, $N_0$ is initial population size, $N_{max}$ is maximum population size.\\
\textbf{Baranyi Model(Eqn 5.)}
\begin{equation}
    N_t = N_0 + r_{max}A_t - ln(1+\frac{e^{r_{max}}A_t-1}{e^{N_{max}-N_0}})\\
\end{equation}
\begin{equation}
    A_t = t + \frac{1}{r_{max}}\cdot ln(\frac{e^{-r_{max}t}+h_0}{1+h_0})\\
\end{equation}
\begin{equation}
    t_{lag} = \frac{ln(1+\frac{1}{h_0})}{r_{max}}
\end{equation}
The Baranyi model introduces a new dimensionless parameter $h_0$ which represents the initial physiological state of the cells. The length of the lag phase is determined by the value of $h_0$ at inoculation and the post-inoculation environment. Essentially it has the same four parameters as the Gompertz model.\\
%Thus the definition of lag is independent from the shape of the growth curve, and the effect of the previous environment is separated from the effects of the present environment. This allows modeling growth without a lag period following inoculation from media favorable to growth to new media also favorable to growth. 
\textbf{Buchunan Model(Eqn 6.)}

\subsection{Data}
The data used in this work are collected through lab experiments, sourced from ten different publications \citep{bae2014growth,bernhardt2018metabolic,galarz2016predicting,gill1991growth,phillips1987relation,roth1962continuity,silva2018modelling,sivonen1990effects, stannard1985temperature,zwietering1994modeling}. The collection contains growth data from 45 species with various culture conditions (temperature and 18 types of medium) for varying replications and time. Prior to the use of the data for model fitting, negative values in population size were removed (population size cannot be negative in reality). The models were written in log to the base 10, therefore the population value was transformed to log base 10.

%Some of the population data were direct counts while some were not.
\subsection{Starting Values Calculation}
The following starting values of the parameters were calculated:
\begin{itemize}
	\item $N_0$: population size at the start of the data
    \item $N_{max}$: highest population size (equation: max(diff(data\$Log10N)/mean(diff(data\$Time))), where data is the used data and $Log10N$ is the log10 population value)
    \item $r_{max}$: maximum growth rate by finding the highest slope of the curve
	\item $t_{lag}$: time at which the difference of the log10 population value was at its peak (equation: data\$Time[which.max(diff(diff(data\$Log10N)))])
\end{itemize}
\subsection{Model Selection Methods}
Three commonly used model selection methods to identify the model best supported by the data(Table 1)\\
\begin{center}
\begin{table}[]
\caption {Used commonly model selection methods}
\begin{threeparttable}
\resizebox{\textwidth}{!}{
\begin{tabular}{@{}lllll@{}}
\toprule
Model selection methods & Calculation & References &  &  \\ \midrule
Adjusted $R^{2}$ (RSS)    & $R_{adj^{2}} = 1 - RSS(n-p-1)\sum (y_i-\bar{y})^2n-1$ & \citealp{rohlf1981biometry}  &  &  \\
Akaike information criterion (AIC)   & AIC = $-2ln[L(\hat{\theta_p}|y)]+2p$  & \citealp{burnham2002practical} &  &  \\
Bayesian information criterion (BIC) & BIC = $-2ln[L(\hat{\theta_p}|y)]+p\cdot ln(n)$  & \citealp{schwarz1978estimating}   &  &  \\ \bottomrule
\end{tabular}}
 \begin{tablenotes}
        \footnotesize
        \item[] $n$, sample size; $p$, count of free parameters; y: data; 
        \item[] $ln[L(\hat{\theta_p}|y)$): likelihood of the model parameters (more precisely, maximum likelihood estimates.
        \item[] $ln[L(\hat{\theta_p}|y)$ given the data, y. 
      \end{tablenotes}
    \end{threeparttable}
\end{table}
\end{center}

The result coincidence of the models were compared on accounts of AIC


The comparison of model used 
Maximizing fit
The Akaike Information Criterion, or AIC, is the most widespread information criterion, and is defined as.
data set are removed according to R square

\subsection{Computing Languages}
R (3.6.0) was used with packages ``minpack.lmâ€œ, ``stats"(Kruskal test and PCA) and ``PMCMR" (post-hoc Nemenyi pairwise comparisons).  Python (ver 3.7.3) was used with package ``subprocess" (streamline project workflow).

Data preparation was done in python 3.6.7. Model fitting and comparison was done in R 3.4.4. 

\section{Results}
17 subset is removed because of R square

the lowest AIC and BIC for each experiment as well as the number of times each model successfully converged was tallied (Table 1.)



\section{Discussion}

\appendix



\bibliography{reference}
  
\end{document}